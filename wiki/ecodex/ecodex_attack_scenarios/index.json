{
  "reference": {
    "path": "wiki/ecodex",
    "baseUrl": "/ecodex",
    "fileName": "ecodex_attack_scenarios",
    "extension": "html",
    "usePrettyUrl": true,
    "link": "/ecodex/wiki/ecodex/ecodex_attack_scenarios"
  },
  "previous": {
    "path": "wiki/ecodex",
    "baseUrl": "/ecodex",
    "fileName": "differences_edelivery_ecodex",
    "extension": "html",
    "usePrettyUrl": true,
    "link": "/ecodex/wiki/ecodex/differences_edelivery_ecodex"
  },
  "data": {},
  "description": "",
  "title": "Attack scenarios on e-Codex",
  "content": "<div id=\"preamble\">\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Overview of the e-Codex Components<\/p>\n<\/div>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Country A<\/p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Gateway<\/p>\n<\/li>\n<li>\n<p>Connector<\/p>\n<\/li>\n<\/ul>\n<\/div>\n<\/li>\n<li>\n<p>Country B<\/p>\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Gateway<\/p>\n<\/li>\n<li>\n<p>Connector<\/p>\n<\/li>\n<\/ul>\n<\/div>\n<\/li>\n<li>\n<p>CMT<\/p>\n<\/li>\n<li>\n<p>Certificate Authority<\/p>\n<\/li>\n<\/ul>\n<\/div>\n<\/div>\n<\/div>\n<div class=\"sect1\">\n<h2 id=\"_security_features\">Security Features<\/h2>\n<div class=\"sectionbody\">\n<div class=\"ulist\">\n<ul>\n<li>\n<p>Messages are only transported between 2 Domains<\/p>\n<\/li>\n<li>\n<p>Decentralized infrastructure - one compromised node only affects communication with this node<\/p>\n<\/li>\n<li>\n<p>Seperated infrastructures for certificate management and configuration management<\/p>\n<\/li>\n<li>\n<p>The IP-Addresses of the partners are known<\/p>\n<\/li>\n<\/ul>\n<\/div>\n<\/div>\n<\/div>\n<div class=\"sect1\">\n<h2 id=\"_attacking_e_codex_e_delivery\">Attacking e-Codex / e-Delivery<\/h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The following text would give a brief overview of angle of attacks at the whole e-Codex infrastructure.<\/p>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_scenario_1_hijacking_an_access_point\">Scenario 1 - Hijacking  an access point.<\/h3>\n<div class=\"paragraph\">\n<p>This is not really a design problem of e-Codex. Because the participants are\nresponsible for their own infrastructure and security. But the problem will only affect the communication\nfrom and to this member state.<\/p>\n<\/div>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_scenario_2_hijacking_the_cmt\">Scenario 2 - Hijacking the CMT<\/h3>\n<div class=\"paragraph\">\n<p>The CMT is responsible for distributing the configuration. The configuration contains all the used\ncertificates and IP-Adresses. So an evil party would have the possibility to modify the p-Modes and\ncertificates of an access-point and this would enable the evil party to intercept the data traffic.<\/p>\n<\/div>\n<div class=\"paragraph\">\n<p>In this example the CMT distributes a configuration where Party A and Party B would get an P-Mode\nconfiguratoin and sets of certificates where a Party B' would act as an transparent proxy.<\/p>\n<\/div>\n<div class=\"paragraph\">\n<p>Party A &lt;&#8594; Party B' &lt;&#8594; Party B<\/p>\n<\/div>\n<div class=\"paragraph\">\n<p>This scenario is prevented by the usage of an 2nd party the Certificate Authority. All certificates\nwithin the e-Codex domain must be issued by this CA. So it would be very hard for Party B' to\nalso get an valid e-Codex Certificate.<\/p>\n<\/div>\n<div class=\"admonitionblock note\">\n<table>\n<tr>\n<td class=\"icon\">\n<div class=\"title\">Note<\/div>\n<\/td>\n<td class=\"content\">\nAn additional security feature would be if the configuration is signed by the party administrator\nbefore it is going to be uploaded to the CMT.\n<\/td>\n<\/tr>\n<\/table>\n<\/div>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_scenario_3_hijacking_of_the_ca\">Scenario 3 - Hijacking of the CA<\/h3>\n<div class=\"paragraph\">\n<p>If the CA is hijacked it would be possible for the attackers to issue valid e-Codex certificates. But\nstill the certificates must also be part of the distributed configuration so also the evil issued\ncertificates must become part of the by the CMT distributed configuration. So also the CMT\nmust be compromised.<\/p>\n<\/div>\n<\/div>\n<\/div>\n<\/div>\n<div class=\"sect1\">\n<h2 id=\"_conclusion\">Conclusion<\/h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>The effort to perform an man-in-the-middle attack would be high. Especially if the whole network should be\novertaken. In this case 2 seperate infrastructures must be captured. The CMT and the Certificate Authority.<\/p>\n<\/div>\n<div class=\"paragraph\">\n<p>Most likely is the sceneario that a single access point is attacked. To prevent this the access-points\nshould monitor the current by the CMT distributed configuration and check them against ther own current\nconfiguration. Also the public available lists of issued certificates should be checked on a regulary\nbasis by the access-point administrator.<\/p>\n<\/div>\n<\/div>\n<\/div>\n<div class=\"sect1\">\n<h2 id=\"_attacking_an_single_access_point\">Attacking an single Access-Point<\/h2>\n<div class=\"sectionbody\">\n<div class=\"paragraph\">\n<p>Not only attacks on the whole network are possible. Also the single access-points can be valuable targets.\nCurrently the e-Codex network is by design public available (through the internet). This gives\nthe network a lot of flexibility but also makes it vulnerable to all kind of security threats.<\/p>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_ip_whitelist\">IP Whitelist<\/h3>\n<div class=\"paragraph\">\n<p>As a first layer of hindering unpleasent guests the CMT is also distributing with the configuration\na list of IP-Addresses. So it is very easy task to simple block the traffic from all IP-Addresses which\nare not within this Whitelist.<\/p>\n<\/div>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_tls_client_authentication\">TLS Client authentication<\/h3>\n<div class=\"paragraph\">\n<p>The next level is the access to the gateway. The AS4 gateway is a simple Webservice. Within the e-Codex\nnetwork it is possible to enable certificate based TLS-Client authentication. So only clients which\ndo have a certificate signed by the RootCA and part of the distributed configuration are granted access\nto the webservice.<\/p>\n<\/div>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_tls_encryption_server_authentication\">TLS Encryption / Server Authentication<\/h3>\n<div class=\"paragraph\">\n<p>As TLS Client authentication is used also the webserver must be authenticated to the client. For this purpose\nalso certificates are used. This certificates also has to be signed by the RootCA. (Currently the\ndomibus gateway does not support that the webserver certificate itself has to exists in the trusted\nwebservers store).\nThe whole communication between the gateway and the webserver is TLS encrypted!<\/p>\n<\/div>\n<div class=\"paragraph\">\n<p>(TODO: define TLS level + at least used Algorithms - TLS1.3)<\/p>\n<\/div>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_as4_message_encryption\">AS4 Message encryption<\/h3>\n<div class=\"paragraph\">\n<p>The over the opened HTTPs channel transported message has been signed and encrpyted by the sending gateway.\nAlso the gateway is doing a sender and recipient certificate validation. So a corrupt webserver will not be\nsufficient to read the message content.<\/p>\n<\/div>\n<\/div>\n<div class=\"sect2\">\n<h3 id=\"_connector_message_signature\">Connector Message signature<\/h3>\n<div class=\"paragraph\">\n<p>The over e-Delivery transported e-Codex messages and evidences are signed by the connector. So any modification\non the gateway or between the two connectors would be detected by receiving connector.<\/p>\n<\/div>\n<\/div>\n<\/div>\n<\/div>"
}